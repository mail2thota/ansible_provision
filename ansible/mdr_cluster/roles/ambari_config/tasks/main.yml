#
# Software Copyright BAE Systems plc 2017. All Rights Reserved.
# BAE SYSTEMS, DETICA are trademarks of BAE Systems
# plc and may be registered in certain jurisdictions.
#
---
- include_vars: "{{playbook_dir}}/roles_config/{{inventoryname}}/{{ hdp_cluster_type }}.yml"
  when: hdp_cluster_type is defined

- name: install python-requests
  yum:
    name: python-requests
    state: installed
  when: hdp_cluster_type is defined
  
- name: deploy cluster with ambari; http://{{ ambari_hosts[0]['name'] }}:{{ ambari_port }}
  ambari_cluster_state:
    host: "{{ ambari_hosts[0]['name'] }}"
    port: "{{ ambari_port }}"
    username: "{{ ambari_user }}"
    password: "{{ ambari_password }}"
    hdp_password: "{{ hdp_password }}"
    cluster_name: "{{ cluster_name }}"
    cluster_state: present
    blueprint_name: "{{ blueprint_name }}"
    configurations: "{{ configurations }}"
    wait_for_complete: True
    blueprint_var: "{{ blueprint }}"
    use_local_repository: "{{ use_local_repository }}"
  when: hdp_stack_version is defined


