#
# Software Copyright BAE Systems plc 2017. All Rights Reserved.
# BAE SYSTEMS, DETICA are trademarks of BAE Systems
# plc and may be registered in certain jurisdictions.
#
---

- name: check firewalld is stopped and is not running at boot time.
  ignore_errors: yes
  service: name=firewalld state=stopped enabled=no

- name: create logrotate script for hadoop services
  template:
    src: "hadoop-logrotate.yml"
    dest: "/etc/logrotate.d/ambari"
    mode: 0644

- name: get the version of python
  shell: yum list installed python | grep python | awk '{print $2}' | cut -d'-' -f1 | cut -d':' -f2
  register: version
  changed_when: False
  args:
    warn: no

- name: locating python
  shell: whereis python | tr " " %
  register: path
  
- name: generate python report
  shell: "{{ playbook_dir }}/report.sh python {{ version.stdout }} N/A {{ path.stdout }} {{ ansible_fqdn }} success {{ inventoryname }}"
  delegate_to: localhost
  when: result|succeeded


